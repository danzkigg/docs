---
title: 'Charging Sessions'
description: 'Manage and track electric vehicle charging sessions'
---

# Charging Sessions

## Overview

Charging sessions represent the complete lifecycle of an electric vehicle charging event, from initiation to completion. The API provides comprehensive tools to start, monitor, and conclude charging sessions.

## Session Lifecycle

1. **Session Initialization**
   - Associate with an RFID card
   - Link to a charging station
   - Record initial vehicle and battery information

2. **Active Charging**
   - Track energy consumption
   - Monitor charging progress
   - Record real-time session events

3. **Session Completion**
   - Calculate total energy consumed
   - Determine session cost
   - Record final vehicle battery status

## Endpoints

### Start a Charging Session

<RequestExample>
```bash
POST /api/v1/sessions/start
```

```json
{
  "card_id": "card-uuid",
  "station_info": {
    "station_id": "station-uuid",
    "initial_battery_level": 20,
    "vehicle_type": "Electric Sedan"
  }
}
```
</RequestExample>

#### Response
<ResponseExample>
```json
{
  "message": "Session started",
  "session": {
    "id": "session-uuid",
    "card_id": "card-uuid",
    "start_time": "2024-01-27T10:30:00Z",
    "session_status": "active",
    "connection_attempts": 1,
    "vehicle_info": {
      "initial_battery_level": 20,
      "vehicle_type": "Electric Sedan"
    }
  }
}
```
</ResponseExample>

### End a Charging Session

<RequestExample>
```bash
PATCH /api/v1/sessions/:sessionId/end
```

```json
{
  "cost": 25.50,
  "energy_consumed": 45.2,
  "final_battery_level": 80
}
```
</RequestExample>

#### Response
<ResponseExample>
```json
{
  "message": "Session ended",
  "session": {
    "id": "session-uuid",
    "end_time": "2024-01-27T11:45:00Z",
    "session_status": "completed",
    "cost": 25.50,
    "energy_consumed": 45.2
  },
  "events": [
    {
      "event_type": "charging_stopped",
      "event_data": {
        "message": "Charging process completed",
        "details": {
          "energyConsumed": 45.2,
          "totalCost": 25.50
        }
      }
    }
  ]
}
```
</ResponseExample>

### List Sessions

Retrieve charging sessions for the authenticated user.

<RequestExample>
```bash
GET /api/v1/sessions
```
</RequestExample>

#### Response
<ResponseExample>
```json
{
  "sessions": [
    {
      "id": "session-uuid-1",
      "start_time": "2024-01-25T14:30:00Z",
      "end_time": "2024-01-25T16:15:00Z",
      "session_status": "completed",
      "energy_consumed": 35.6,
      "cost": 18.75
    },
    {
      "id": "session-uuid-2",
      "start_time": "2024-01-26T09:15:00Z",
      "session_status": "active"
    }
  ]
}
```
</ResponseExample>

### Retrieve Session Events

Get detailed events for a specific session.

<RequestExample>
```bash
GET /api/v1/sessions/:sessionId/events
```
</RequestExample>

#### Response
<ResponseExample>
```json
{
  "events": [
    {
      "event_type": "session_start",
      "created_at": "2024-01-27T10:30:00Z",
      "event_data": {
        "message": "Charging session initiated",
        "initial_battery_level": 20
      }
    },
    {
      "event_type": "charging_status",
      "created_at": "2024-01-27T10:45:00Z",
      "event_data": {
        "message": "Charging in progress",
        "current_battery_level": 35,
        "charging_rate": 7.2
      }
    }
  ]
}
```
</ResponseExample>

### Get Active Sessions (Admin)

Retrieve all currently active charging sessions.

<RequestExample>
```bash
GET /api/v1/sessions/active
```
</RequestExample>

#### Response
<ResponseExample>
```json
{
  "sessions": [
    {
      "id": "session-uuid",
      "start_time": "2024-01-27T10:30:00Z",
      "user": {
        "id": "user-uuid",
        "email": "user@example.com",
        "first_name": "John",
        "last_name": "Doe"
      }
    }
  ]
}
```
</ResponseExample>

### Force Stop Session (Admin)

Terminate an active charging session.

<RequestExample>
```bash
PATCH /api/v1/sessions/:sessionId/stop
```

```json
{
  "reason": "Maintenance required"
}
```
</RequestExample>

#### Response
<ResponseExample>
```json
{
  "message": "Session force stopped",
  "session": {
    "id": "session-uuid",
    "session_status": "completed"
  },
  "events": [
    {
      "event_type": "admin_force_stop",
      "event_data": {
        "message": "Session force stopped by administrator",
        "reason": "Maintenance required"
      }
    }
  ]
}
```
</ResponseExample>

## Session Statistics

### User Session Statistics

<RequestExample>
```bash
GET /api/v1/sessions/user/:userId/stats
```
</RequestExample>

#### Response
<ResponseExample>
```json
{
  "stats": {
    "total_sessions": 15,
    "successful_sessions": 14,
    "total_energy": 542.3,
    "total_cost": 275.50,
    "favorite_stations": [
      ["station-uuid-1", 8],
      ["station-uuid-2", 5]
    ]
  },
  "sessions": [...]
}
```
</ResponseExample>

## Best Practices

- Always validate RFID card before starting a session
- Handle potential connection interruptions
- Implement proper error handling
- Store session metadata for future analysis

## Common Errors

| Status Code | Error Message | Description |
|------------|--------------|-------------|
| 400 | Invalid session | Attempt to perform action on invalid session |
| 403 | Not authorized | User lacks permissions for the action |
| 404 | Session not found | Requested session does not exist |

## Code Example: Session Management

```javascript
// Start a charging session
const startChargingSession = async (cardId, stationInfo) => {
  const response = await fetch('/api/v1/sessions/start', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${accessToken}`
    },
    body: JSON.stringify({ 
      card_id: cardId, 
      station_info: stationInfo 
    })
  });

  return await response.json();
};

// End a charging session
const endChargingSession = async (sessionId, sessionData) => {
  const response = await fetch(`/api/v1/sessions/${sessionId}/end`, {
    method: 'PATCH',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${accessToken}`
    },
    body: JSON.stringify(sessionData)
  });

  return await response.json();
};
```

---

Need more details? [Contact Support](/support) for assistance with charging sessions.